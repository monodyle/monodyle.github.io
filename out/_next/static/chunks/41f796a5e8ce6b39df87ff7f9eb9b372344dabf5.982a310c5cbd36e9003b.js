(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[5],{fMoX:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return p})),n.d(t,"default",(function(){return j}));var c=n("wx14"),a=n("Ff2n"),b=n("q1tI"),o=n.n(b),l=n("7ljp"),r=n("ueqM"),p=(o.a.createElement,{date:"Mar 15, 2020",slug:"/blog/sql-database-hacking",image:"/blog/sql-database-hacking/featured.jpg",title:"M\u1ea5y c\xe1i tr\xf2 Database Hacking",description:"H\xf4m n\u1ecd m\xecnh v\u1eeba \u0111\u1ecdc \u0111\u01b0\u1ee3c m\u1ed9t b\xe0i write-up c\u1ee7a m\u1ed9t b\u1ea1n White-hat sau khi b\xe1o c\xe1o l\u1ea1i l\u1ed7 h\u1ed5ng tr\xean trang web c\u1ee7a \u0110\u1ea1i h\u1ecdc Harvard, t\u1ef1 d\u01b0ng th\u1ea5y k\u1ef9 n\u0103ng v\u1ec1 b\u1ea3o m\u1eadt c\u1ee7a m\xecnh bao l\xe2u nay... k\xe9m gh\xea",tags:["dev","web","database","hacking","security"]}),s={meta:p},h=Object(r.a)(p);function j(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(l.b)(h,Object(c.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"H\xf4m n\u1ecd m\xecnh v\u1eeba \u0111\u1ecdc \u0111\u01b0\u1ee3c m\u1ed9t b\xe0i write-up c\u1ee7a m\u1ed9t b\u1ea1n white-hat sau khi b\xe1o c\xe1o l\u1ea1i l\u1ed7 h\u1ed5ng SQL Injection tr\xean trang web c\u1ee7a \u0110\u1ea1i h\u1ecdc Harvard, t\u1ef1 d\u01b0ng th\u1ea5y k\u1ef9 n\u0103ng v\u1ec1 b\u1ea3o m\u1eadt c\u1ee7a m\xecnh bao l\xe2u nay... k\xe9m gh\xea."),Object(l.b)("p",null,"B\u1ea3n th\xe2n l\xe0 sinh vi\xean chuy\xean ng\xe0nh ",Object(l.b)("strong",{parentName:"p"},"H\u1ec7 Th\u1ed1ng Th\xf4ng Tin"),", t\u1ee9c l\xe0 chuy\xean ng\u1ed3i \u0111\u1ea5u v\u1eadt v\u1edbi m\u1ea5y c\xe1i c\u01a1 s\u1edf d\u1eef li\u1ec7u m\xe0 l\u1ea1i r\u1ea5t hay qu\xean \u0111i nh\u1eefng c\xe1i quan tr\u1ecdng nh\u01b0 th\u1ebf n\xe0y... C\u1ea3m th\u1ea5y x\u1ea5u h\u1ed5, th\u1ebf l\xe0 m\xecnh ph\u1ea3i m\xf2 l\u1ea1i nh\u1eefng g\xec m\xecnh \u0111\xe3 h\u1ecdc, nh\u01b0ng kh\xf4ng d\xf9ng t\u1edbi l\u1ea1i qu\xean m\u1ea5t, r\u1ed3i vi\u1ebft th\xe0nh m\u1ed9t blog \u0111\u1ec3 coi nh\u01b0 v\u1eeba h\u1ecdc l\u1ea1i, v\u1eeba chia s\u1ebb ki\u1ebfn th\u1ee9c cho m\u1ecdi ng\u01b0\u1eddi :smug: ",Object(l.b)("del",{parentName:"p"},"M\xecnh th\u1eadt tuy\u1ec7t")),Object(l.b)("h2",{id:"th\u1eb1ng-ch\xf3-m\xe0y-hack-web-b\u1ed1-m\xe0y"},"Th\u1eb1ng ch\xf3, m\xe0y hack web b\u1ed1 m\xe0y..."),Object(l.b)("p",null,"H\xe8 v\u1eeba r\u1ed3i m\xecnh c\xf3 tr\xf2 chuy\u1ec7n v\u1edbi m\u1ed9t \xf4ng anh trong ngh\u1ec1, \u1ed5ng t\xe2m s\u1ef1 v\u1ec1 chuy\u1ec7n b\u1ecb th\u1eb1ng n\xe0o th\u1ea3 bot n\xf3 clean m\u1eb9 c\xe1i database, \u0111\u1ec3 l\u1ea1i \u0111\xfang m\u1ed9t d\xf2ng duy nh\u1ea5t:"),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"G\u1eedi b\u1ed1 m\xe0y v\xe0i Bitcoin \u0111\xea, b\u1ed1 m\xe0y tr\u1ea3 l\u1ea1i d\u1eef li\u1ec7u cho... :lookdown:")),Object(l.b)("p",null,"V\xe0 k\xe8m theo \u0111\xf3 l\xe0 \u0111\u1ecba ch\u1ec9 v\xed bitcoin c\u1ee7a h\u1eafn :surrender: T\xednh \xf4ng anh m\xecnh \u0111\u01b0\u1ee3c c\xe1i th\u1eadt th\xe0, nh\xe0 c\u0169ng kh\xf4ng c\xf3 g\xec ngo\xe0i \u0111i\u1ec1u ki\u1ec7n, th\u1ebf l\xe0 g\u1eedi cho n\xf3 v\xe0i bitcoin coi nh\u01b0 ti\u1ec1n \u0103n s\xe1ng, h\xf4m sau th\u1ea5y n\xf3 restore l\u1ea1i d\u1eef li\u1ec7u th\u1eadt :mokas:"),Object(l.b)("p",null,"Nh\u01b0ng m\xe0 t\u1ee9c qu\xe1, ai \u0111\u1eddi l\xe0m l\u1eadp tr\xecnh c\xf3 s\u1ea3n ph\u1ea9m \u0111ang ch\u1ea1y ph\xe0 ph\xe0 l\u1ea1i c\xf3 th\u1eb1ng cho\xe1 n\xe0o hack, ngh\u0129 c\xf3 cay kh\xf4ng c\u01a1 ch\u1ee9? :yikes:"),Object(l.b)("p",null,"M\xecnh kh\xf4ng r\xf5 l\xe0 c\xe1i database \u0111\xf3 b\u1ecb hack nh\u01b0 th\u1ebf n\xe0o, nh\u01b0ng kh\xe1 ch\u1eafc ch\u1eafn ph\u1ea7n l\u1edbn l\xe0 b\u1edfi v\xec code ch\u01b0a \u0111\u1ee7 b\u1ea3o m\u1eadt v\xe0 c\xf3 nhi\u1ec1u l\u1ed7 h\u1ed5ng. C\xe1c hacker s\u1ebd vi\u1ebft m\u1ed9t con bot chuy\xean \u0111i d\u1ea1o tr\xean m\u1ea1ng \u0111\u1ec3 attack v\xe0o nh\u1eefng case b\u1ea3o m\u1eadt th\u01b0\u1eddng d\u1ec5 b\u1ecb hack nh\u1ea5t."),Object(l.b)("p",null,"V\xec v\u1eady b\xe0i vi\u1ebft n\xe0y m\xecnh s\u1ebd gi\u1edbi thi\u1ec7u cho c\xe1c b\u1ea1n m\u1ed9t lo\u1ea1i l\u1ed7 h\u1ed5ng ",Object(l.b)("strong",{parentName:"p"},"c\u01a1 b\u1ea3n")," nh\u01b0ng c\u1ef1c k\u1ef3 nguy hi\u1ec3m, gi\u1ea3i th\xedch c\u01a1 ch\u1ebf v\xe0 h\u01b0\u1edbng d\u1eabn c\xe1ch ph\xf2ng ch\u1ed1ng. V\xe0 xin gi\u1edbi thi\u1ec7u c\xe1i tr\xf2 g\u1ecdi l\xe0 ",Object(l.b)("strong",{parentName:"p"},"SQL Injection"),"."),Object(l.b)("div",{className:"note",emoji:"1"},Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"L\u01b0u \xfd:")),Object(l.b)("p",null,"B\xe0i vi\u1ebft n\xe0y nh\u1eb1m m\u1ee5c \u0111\xedch giao l\u01b0u k\u1ef9 n\u0103ng b\u1ea3o m\u1eadt l\u1eadp tr\xecnh, kh\xf4ng c\u1ed5 su\xfd c\xe1c b\u1ea1n \u0111i ph\xe1 l\xe0ng ph\xe1 x\xf3m. H\xe3y t\u1ec9nh t\xe1o :smug:")),Object(l.b)("h2",{id:"nh\u1eadp-m\xf4n-hack-c\u01a1-s\u1edf-d\u1eef-li\u1ec7u-sql"},"Nh\u1eadp m\xf4n hack C\u01a1 s\u1edf d\u1eef li\u1ec7u SQL"),Object(l.b)("p",null,"Trong nhi\u1ec1u lo\u1ea1i t\u1ea5n c\xf4ng l\u1ed7 h\u1ed5ng nh\u1eb1m v\xe0o website, t\u1ea5n c\xf4ng ",Object(l.b)("strong",{parentName:"p"},"SQL Injection")," l\xe0 m\u1ed9t trong nh\u1eefng lo\u1ea1i nguy hi\u1ec3m v\xe0 ph\u1ed5 bi\u1ebfn nh\u1ea5t. N\xf3 \u0111\xe3 t\u1eebng g\xe2y ra nhi\u1ec1u thi\u1ec7t h\u1ea1i \u0111\xe1ng k\u1ec3 cho nhi\u1ec1u doanh nghi\u1ec7p v\xe0 t\u1ed5 ch\u1ee9c trong r\u1ea5t nhi\u1ec1u n\u0103m, v\xe0 \u0111\u01b0\u01a1ng nhi\xean s\u1ebd c\xf2n ti\u1ebfp di\u1ec5n trong t\u01b0\u01a1ng lai."),Object(l.b)("img",{title:"SQL Injection l\xe0 g\xec??",alt:"SQL Injection l\xe0 g\xec??",src:"/blog/sql-database-hacking/draw-01.jpg"}),Object(l.b)("p",null,"Theo ",Object(l.b)("a",Object(c.a)({parentName:"p"},{href:"https://vi.wikipedia.org/wiki/SQL_injection"}),"Wikipedia")," :popcorn::"),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},Object(l.b)("strong",{parentName:"p"},"SQL injection")," l\xe0 m\u1ed9t k\u1ef9 thu\u1eadt cho ph\xe9p nh\u1eefng k\u1ebb t\u1ea5n c\xf4ng l\u1ee3i d\u1ee5ng l\u1ed7 h\u1ed5ng c\u1ee7a vi\u1ec7c ki\u1ec3m tra d\u1eef li\u1ec7u \u0111\u1ea7u v\xe0o trong c\xe1c \u1ee9ng d\u1ee5ng web v\xe0 c\xe1c th\xf4ng b\xe1o l\u1ed7i c\u1ee7a h\u1ec7 qu\u1ea3n tr\u1ecb c\u01a1 s\u1edf d\u1eef li\u1ec7u tr\u1ea3 v\u1ec1 \u0111\u1ec3 ",Object(l.b)("em",{parentName:"p"},"inject")," (",Object(l.b)("em",{parentName:"p"},"ti\xeam v\xe0o"),") v\xe0 thi h\xe0nh c\xe1c c\xe2u l\u1ec7nh SQL ",Object(l.b)("u",null,"b\u1ea5t h\u1ee3p ph\xe1p"),".")),Object(l.b)("p",null,"\u1edc th\xec kh\xe1i ni\u1ec7m nh\u01b0 v\u1eady \u0111\u1ea5y, hi\u1ec3u m\u1ed9t c\xe1ch \u0111\u01a1n gi\u1ea3n t\u1ee9c l\xe0 lo\u1ea1i t\u1ea5n c\xf4ng n\xe0y nh\u1eb1m v\xe0o c\xe1c ",Object(l.b)("strong",{parentName:"p"},"input")," c\xf3 ",Object(l.b)("strong",{parentName:"p"},"t\u01b0\u01a1ng t\xe1c tr\u1ef1c ti\u1ebfp")," v\u1edbi ",Object(l.b)("strong",{parentName:"p"},"database")," \u1edf ",Object(l.b)("strong",{parentName:"p"},"back-end")," (v\xed d\u1ee5 nh\u01b0 c\xe1c input email, password \u1edf form login). Th\xf4ng th\u01b0\u1eddng, attacker s\u1ebd t\u1ea5n c\xf4ng \u0111\u1ec3 \u0103n c\u1eafp d\u1eef li\u1ec7u, lo\u1ea1i n\xe0y v\u1ec1 c\u01a1 b\u1ea3n l\xe0 hi\u1ec1n nh\u1ea5t, sau \u0111\xf3 t\u1edbi x\xe1o tr\u1ed9n d\u1eef li\u1ec7u \u0111\u1ec3 c\u1ea3n tr\u1edf s\u1ef1 ho\u1ea1t \u0111\u1ed9ng c\u1ee7a website, v\xe0 tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, l\xe0 quy\u1ec1n truy c\u1eadp qu\u1ea3n tr\u1ecb v\xe0o m\xe1y ch\u1ee7 database b\u1ecb chi\u1ebfm. :moka:"),Object(l.b)("p",null,"Trong l\u1ecbch s\u1eed, \u0111\xe3 c\xf3 r\u1ea5t nhi\u1ec1u \u0111\u1ee3t t\u1ea5n c\xf4ng SQL Injection nh\u1eb1m m\u1ee5c \u0111\xedch:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Tr\xedch xu\u1ea5t th\xf4ng tin nh\u1ea1y c\u1ea3m, v\xed d\u1ee5 nh\u01b0 v\u1ec1 an sinh x\xe3 h\u1ed9i, hay th\xf4ng tin th\u1ebb t\xedn d\u1ee5ng"),Object(l.b)("li",{parentName:"ul"},"Tr\xedch xu\u1ea5t th\xf4ng tin ng\u01b0\u1eddi d\xf9ng \u0111\xe3 \u0111\u01b0\u1ee3c \u0111\u0103ng k\xfd tr\xean c\xe1c website, \u1edf Vi\u1ec7t Nam c\u0169ng kh\xf4ng \xedt tr\u01b0\u1eddng h\u1ee3p"),Object(l.b)("li",{parentName:"ul"},"Xo\xe1 lu\xf4n c\xe1i database, c\xf3 r\u1ea5t nhi\u1ec1u trang web kh\xf4ng s\u1eed d\u1ee5ng backup d\u1eef li\u1ec7u, v\xe0 khi b\u1ecb xo\xe1 th\xec coi nh\u01b0 c\u1ea3 h\u1ec7 th\u1ed1ng t\xea li\u1ec7t, v\xed d\u1ee5 c\u1ee7a \xf4ng anh b\xean tr\xean l\xe0 v\xed d\u1ee5 g\u1ea7n g\u0169i nh\u1ea5t"),Object(l.b)("li",{parentName:"ul"},"Ti\xeam m\xe3 \u0111\u1ed9c th\u1ef1c thi v\xe0o trang web khi ng\u01b0\u1eddi d\xf9ng truy c\u1eadp")),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Nh\u1eafc l\u1ea1i m\u1ed9t l\u1ea7n n\u1eefa:")," T\u1ea5n c\xf4ng v\u1ec1 SQL Injection c\u1ef1c k\u1ef3 ph\u1ed5 bi\u1ebfn. C\xe1c c\xf4ng ty l\u1edbn nh\u01b0 ",Object(l.b)("strong",{parentName:"p"},"Yahoo")," hay ",Object(l.b)("strong",{parentName:"p"},"Sony")," \u0111\xe3 t\u1eebng l\xe0 nh\u1ea1n nh\xe2n c\u1ee7a tr\xf2 ch\u01a1i n\xe0y. C\xe1c nh\xf3m hacker c\xf2n vi\u1ebft h\u1eb3n c\xe1c script bot \u0111\u1ec3 t\u1ef1 \u0111i t\u1ea5n c\xf4ng d\u1ea1o tr\xean internet, v\xec v\u1eady h\xe3y lu\xf4n c\u1ea9n th\u1eadn v\u1edbi s\u1ea3n ph\u1ea9m c\u1ee7a b\u1ea1n."),Object(l.b)("h3",{id:"c\u01a1-ch\u1ebf-khai-th\xe1c-v\xe0-t\u1ea5n-c\xf4ng"},"C\u01a1 ch\u1ebf khai th\xe1c v\xe0 t\u1ea5n c\xf4ng"),Object(l.b)("p",null,"SQL Injection t\u1ea5n c\xf4ng b\u1eb1ng c\xe1ch g\u1eedi m\u1ed9t m\xe3 l\u1ec7nh SQL \u0111\u1ed9c \u0111\u1ebfn back-end c\u1ee7a m\xe1y ch\u1ee7 c\u01a1 s\u1edf \u0111\u1eef li\u1ec7u, th\xf4ng qua c\xe1c request c\u1ee7a ng\u01b0\u1eddi d\xf9ng m\xe0 website cho ph\xe9p. B\u1ea5t k\u1ef3 input n\xe0o c\u0169ng c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 g\u1eedi m\xe3 \u0111\u1ed9c, t\u1ee9c l\xe0 bao g\u1ed3m c\u1ea3: c\xe1c th\u1ebb ",Object(l.b)("inlineCode",{parentName:"p"},"<input>")," nh\u1eadp li\u1ec7u, query strings, cookies v\xe0 file upload."),Object(l.b)("p",null,"M\xecnh s\u1ebd c\xf3 m\u1ed9t v\xed d\u1ee5 nh\u01b0 sau: Gi\u1ea3 s\u1eed \u0111\xe2y l\xe0 trang \u0111\u0103ng nh\u1eadp v\xe0o ng\xe2n h\xe0ng ",Object(l.b)("strong",{parentName:"p"},"PankHub"),", v\u1edbi form \u0111\u0103ng nh\u1eadp g\u1ed3m 2 fields l\xe0 ",Object(l.b)("inlineCode",{parentName:"p"},"email")," v\xe0 ",Object(l.b)("inlineCode",{parentName:"p"},"password"),":"),Object(l.b)("img",{src:"/blog/sql-database-hacking/02.jpg"}),Object(l.b)("p",null,"B\xe2y gi\u1edd m\xecnh s\u1ebd th\u1eed \u0111\u0103ng nh\u1eadp t\xe0i kho\u1ea3n c\u1ee7a ng\u01b0\u1eddi d\xf9ng t\xean l\xe0 ",Object(l.b)("strong",{parentName:"p"},"Ph\xe1t")," (jk, don't panic) v\u1edbi ",Object(l.b)("em",{parentName:"p"},"email")," l\xe0: ",Object(l.b)("inlineCode",{parentName:"p"},"phat.nhagiau@pankhub.com")," v\xe0 ",Object(l.b)("em",{parentName:"p"},"password")," l\xe0 ",Object(l.b)("inlineCode",{parentName:"p"},"password")),Object(l.b)("img",{src:"/blog/sql-database-hacking/03.jpg"}),Object(l.b)("p",null,"\u1eea th\xec \u0111\u01b0\u01a1ng nhi\xean l\xe0 kh\xf4ng \u0111\u0103ng nh\u1eadp \u0111\u01b0\u1ee3c r\u1ed3i :okay: \u0110\xe2y l\xe0 tr\u01b0\u1eddng h\u1ee3p gi\u1ea3 s\u1eed m\xecnh l\xe0 m\u1ed9t attacker, v\xe0 m\xecnh t\xecnh c\u1edd \u0111\u1ecba \u0111\u01b0\u1ee3c email c\u1ee7a ng\u01b0\u1eddi d\xf9ng n\xe0y sau khi \u0111i ngang qua l\xfac n\xf3 \u0111ang \u0111\u0103ng nh\u1eadp v\xe0o ng\xe2n h\xe0ng \u1edf ti\u1ec7m net :smug: Victim c\u1ee7a m\xecnh l\xe0 m\u1ed9t th\u1eb1ng \u0111\u1ea1i gia nh\xe0 gi\xe0u, ti\u1ec1n kh\xf4ng nh\u1eefng \u0111\u01b0\u1ee3c quy ra b\u1eb1ng v\xe0ng \u0111\u1ec3 trong k\xe9t m\xe0 c\xf2n c\xf3 c\u1ea3 m\u1ed9t \u0111\u1ed1ng trong nh\xe0 b\u0103ng. X\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c m\u1ee5c ti\xeau th\xec tr\xedch xu\u1ea5t th\xf4ng tin m\u1ee5c ti\xeau l\xe0 \u0111i\u1ec1u c\u1ea7n thi\u1ebft. V\xec v\u1eady m\xecnh ch\u1ec9 th\u1eed \u0111\u0103ng nh\u1eadp cho vui th\xf4i, \u0111\u01b0\u01a1ng nhi\xean l\xe0m g\xec c\xf3 th\u1eb1ng ",Object(l.b)("del",{parentName:"p"},"ngu")," n\xe0o \u0111\u1eb7t m\u1eadt kh\u1ea9u l\xe0 ",Object(l.b)("inlineCode",{parentName:"p"},"password")," c\u01a1 ch\u1ee9 (jk)"),Object(l.b)("p",null,"B\xe2y gi\u1edd h\xe3y nh\xecn v\u1ea5n \u0111\u1ec1 t\u1eeb ph\xeda server log nh\xe9, ch\xfang ta s\u1ebd c\xf3 1 c\xe1i logging nh\u01b0 sau:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{style:["color: undefined"]}),"Rendering login page.\nChecking supplied authentication details for phat.nhagiau@pankhub.com.\nFinding user in database.\nNo such user, report this to the user (invalid credentials?).\nRendering login page.\n")),Object(l.b)("p",null,"Sau \u0111\xf3, m\xecnh ti\u1ebfp t\u1ee5c truy th\u1eed login v\xe0o t\xe0i kho\u1ea3n c\u1ee7a victim, nh\u01b0ng l\u1ea7n n\xe0y password m\xecnh s\u1ebd th\xeam m\u1ed9t ",Object(l.b)("em",{parentName:"p"},"d\u1ea5u nh\xe1y \u0111\u01a1n")," ",Object(l.b)("inlineCode",{parentName:"p"},"'"),", k\u1ebft qu\u1ea3 c\xf3 \u0111\u01b0\u1ee3c l\xe0:"),Object(l.b)("img",{src:"/blog/sql-database-hacking/04.jpg"}),Object(l.b)("p",null,"Th\u1ea5y s\u1ef1 kh\xe1c bi\u1ec7t r\u1ed3i ph\u1ea3i kh\xf4ng? Th\xf4ng th\u01b0\u1eddng, v\u1edbi nh\u1eefng tr\u01b0\u1eddng h\u1ee3p sai th\xf4ng tin \u0111\u0103ng nh\u1eadp s\u1ebd lu\xf4n cho ra m\u1ed9t message l\u1ed7i (trang n\xe0o n\xf3 random message th\xec b\xf3 tay), v\xec v\u1eady c\xf3 g\xec \u0111\xf3 kh\xf4ng \u0111\xfang x\u1ea3y ra r\u1ed3i, c\xf3 th\u1ec3 nguy\xean do l\xe0 b\u1edfi d\u1ea5u nh\xe1y \u0111\u01a1n ch\u0103ng?"),Object(l.b)("p",null,"Server log:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{style:["color: undefined"]}),"...\n\nRendering login page.\nChecking supplied authentication details for phat.nhagiau@pankhub.com.\nFinding user in database.\nAn error occurred: PG::SyntaxError: ERROR: unterminated quoted string at or near \"'password'' limit 1\" LINE 1: ...ers where email = 'phat.nhagiau@pankhub.com' and password = 'password'... ^ : select * from users where email = 'phat.nhagiau@pankhub.com' and password = 'password'' limit 1.\nUnable to login this user due to unexpected error.\nRendering login page.\n")),Object(l.b)("p",null,"Nh\xecn th\u1ea5y \u1edf log hi\u1ec3n th\u1ecb SQL syntax error ch\u1ee9? \u0110i\u1ec1u n\xe0y ch\u1ee9ng t\u1ecf d\u1ea5u nh\xe1y \u0111\u01a1n ch\xednh l\xe0 nguy\xean nh\xe2n g\xe2y ra l\u1ed7i. Th\u1eed gh\xe9p v\xe0o c\xe2u l\u1ec7nh SQL \u0111\u01b0\u1ee3c ch\u1ea1y tr\xean server th\xec n\xf3 s\u1ebd tr\xf4ng nh\u01b0 th\u1ebf n\xe0y:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-sql"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SELECT"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"*"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"FROM"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," users"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"WHERE"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," email "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'phat.nhagiau@pankhub.com'"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"   "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"AND"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," pass  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'password'' LIMIT 1"),"\n")),Object(l.b)("p",null,"D\u01b0 1 d\u1ea5u nh\xe1y \u0111\u01a1n, c\xe2u l\u1ec7nh n\xe0y ch\u1ea1y trong SQL ch\u1eafc ch\u1eafn s\u1ebd l\u1ed7i. V\xe0 \u0111\xe2y ch\xednh l\xe0 th\u1ee9 g\u1ecdi l\xe0 ",Object(l.b)("strong",{parentName:"p"},"SQL Injection"),"."),Object(l.b)("p",null,"Sau khi x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c l\u1ed7 h\u1ed5ng, m\xecnh s\u1ebd th\u1eed \u0111\u0103ng nh\u1eadp l\u1ea1i v\u1edbi password l\xe0 ",Object(l.b)("strong",{parentName:"p"},Object(l.b)("inlineCode",{parentName:"strong"},"' OR 1=1--")),". C\xe2u l\u1ec7nh SQL l\xfac n\xe0y \u0111\u01b0\u1ee3c th\u1ef1c thi tr\xean server s\u1ebd l\xe0:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-sql"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SELECT"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"*"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"FROM"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," users"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"WHERE"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," email "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'phat.nhagiau@pankhub.com'"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"   "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"AND"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," pass  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"''"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"OR"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"1"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"1"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"--' LIMIT 1"),"\n")),Object(l.b)("p",null,"Server log:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{style:["color: undefined"]}),"Rendering login page.\nChecking supplied authentication details for phat.nhagiau@pankhub.com.\nFinding user in database.\nAuthentication details confirmed, establishing session for this user.\n")),Object(l.b)("img",{src:"/blog/sql-database-hacking/05.jpg"}),Object(l.b)("p",null,"Xong, t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n n\u1eb1m trong tay t\xf4i :ok:"),Object(l.b)("p",null,"C\u01a1 ch\u1ebf ho\u1ea1t \u0111\u1ed9ng \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u1ee7a ",Object(l.b)("strong",{parentName:"p"},"SQL Injection")," l\xe0 nh\u01b0 v\u1eady \u0111\u1ecd. Th\u1ef1c thi n\xf3 kh\xf4ng h\u1ec1 kh\xf3, nh\u01b0ng \u0111\u1ec3 nh\u1eadn ra \u0111\u01b0\u1ee3c trang n\xe0o c\xf3 l\u1ed7 h\u1ed5ng th\xec l\u1ea1i kh\xe1 kh\xf3, v\xec kh\xf4ng ph\u1ea3i l\xfac n\xe0o khai th\xe1c l\u1ed7 h\u1ed5ng SQL Injection n\xf3 c\u0169ng y chang nh\u01b0 v\u1eady."),Object(l.b)("h3",{id:"nh\u01b0ng-t\u1ea1i-sao-c\xf3-l\u1ed7-h\u1ed5ng-n\xe0y"},"Nh\u01b0ng t\u1ea1i sao c\xf3 l\u1ed7 h\u1ed5ng n\xe0y?"),Object(l.b)("p",null,"L\xfd do l\u1edbn nh\u1ea5t l\xe0 c\xe1c b\u1ea1n ch\u01b0a th\u1ec3 ti\u1ebfp c\u1eadn to\xe0n b\u1ed9 c\xe1c case trong qu\xe1 tr\xecnh code. B\u1ea1n kh\xf4ng bao gi\u1edd l\u01b0\u1eddng tr\u01b0\u1edbc \u0111\u01b0\u1ee3c ng\u01b0\u1eddi d\xf9ng s\u1ebd l\xe0m c\xe1i ",Object(l.b)("del",{parentName:"p"},"\u0111\xe9o")," g\xec tr\xean s\u1ea3n ph\u1ea9m c\u1ee7a m\xecnh. :sad: Ch\xednh v\xec v\u1eady th\u01b0\u1eddng c\xe1c case kh\xf4ng bao gi\u1edd \u0111\u01b0\u1ee3c ngh\u0129 t\u1edbi n\xe0y l\u1ea1i v\xf4 t\xecnh t\u1ea1o ra l\u1ed7 h\u1ed5ng cho attacker khai th\xe1c."),Object(l.b)("p",null,"Khi vi\u1ebft c\xe1c c\xe2u l\u1ec7nh SQL trong source (\u1edf \u0111\xe2y m\xecnh s\u1ebd l\u1ea5y ",Object(l.b)("strong",{parentName:"p"},"PHP")," l\xe0m v\xed d\u1ee5), \u0111a s\u1ed1 c\xe1c b\u1ea1n th\u01b0\u1eddng vi\u1ebft ki\u1ec3u:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-php"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$query = "SELECT * FROM USERS'),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  WHERE email = '\" . $_POST['email'] . \"'"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  AND password = '\" . $_POST['password'] . \"'"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'  LIMIT 1;"'),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$result = $connection->query($sql);"),"\n")),Object(l.b)("p",null,"Khi ng\u01b0\u1eddi d\xf9ng g\u1eedi request \u0111\u0103ng nh\u1eadp c\xf3 th\xf4ng tin, th\xec c\xe2u query tr\xean s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-sql"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SELECT"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"*"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"FROM"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," USERS"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"WHERE"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," email "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'phat.nhagiau@pankhub.com'"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"   "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"AND"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," password "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'password'"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"LIMIT"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"1"),"\n")),Object(l.b)("p",null,"T\u1ee9c l\xe0 c\xe1i g\xec g\u1eedi l\xean, th\xec param t\u01b0\u01a1ng \u0111\u01b0\u01a1ng s\u1ebd \u0111\u01b0\u1ee3c thay th\u1ebf b\u1eb1ng c\xe1i \u0111\xf3. \u0110i\u1ec1u n\xe0y v\xf4 t\xecnh t\u1ea1o ra m\u1ed9t l\u1ed7 h\u1ed5ng c\u1ef1c k\u1ef3 nguy hi\u1ec3m. N\u1ebfu b\u1ea1n t\u1eebng h\u1ecdc c\xe1c m\xf4n li\xean quan t\u1edbi database ho\u1eb7c l\xe0m vi\u1ec7c v\u1edbi database nhi\u1ec1u, c\xe1c b\u1ea1n c\xf3 th\u1ec3 hi\u1ec3u r\u1eb1ng ch\u1ec9 v\u1edbi nh\u1eefng c\xe2u l\u1ec7nh SQL th\xf4i c\u0169ng \u0111\u1ee7 \u0111\u1ec3 ch\xfang l\xe0m b\u1ea5t c\u1ee9 th\u1ee9 g\xec li\xean quan t\u1edbi d\u1eef li\u1ec7u."),Object(l.b)("p",null,"Kh\xf4ng nh\u1eefng th\u1ebf, SQL Injection c\xf2n c\xf3 th\u1ec3 th\u1ef1c thi \u0111\u01b0\u1ee3c m\xe3 HTML ho\u1eb7c PHP trong nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p. \u0110\xf3 l\xe0 l\xfd do t\u1ea1i sao l\u1ed7 h\u1ed5ng n\xe0y nghi\xeam tr\u1ecdng nh\u01b0 v\u1eady."),Object(l.b)("h3",{id:"ch\u1ed1ng-injection-nh\u01b0-th\u1ebf-n\xe0o"},"Ch\u1ed1ng injection nh\u01b0 th\u1ebf n\xe0o?"),Object(l.b)("h4",{id:"truy-v\u1ea5n-tham-s\u1ed1-parameterized-statements"},"Truy v\u1ea5n tham s\u1ed1 (Parameterized Statements)"),Object(l.b)("p",null,"\u0110a s\u1ed1 c\xe1c ng\xf4n ng\u1eef l\u1eadp tr\xecnh h\u1ed7 tr\u1ee3 truy v\u1ea5n SQL \u0111\u1ec1u s\u1ebd h\u1ed7 tr\u1ee3 ch\u1ea1y c\xe1c c\xe2u l\u1ec7nh SQL b\u1eb1ng c\xe1ch t\u1ea1o truy v\u1ea5n \u0111\u1ec3 tr\xedch xu\u1ea5t c\xe1c tham s\u1ed1 khi c\u1ea7n thi\u1ebft. C\xe1c c\xe2u l\u1ec7nh n\xean \u0111\u01b0\u1ee3c ",Object(l.b)("em",{parentName:"p"},"tham s\u1ed1 ho\xe1")," \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng c\xe1c ",Object(l.b)("em",{parentName:"p"},"tham s\u1ed1")," (t\u1ee9c l\xe0 ",Object(l.b)("em",{parentName:"p"},"d\u1eef li\u1ec7u \u0111\u1ea7u v\xe0o"),") \u0111\u01b0a v\xe0o c\xe2u l\u1ec7nh SQL \u0111\u01b0\u1ee3c x\u1eed l\xfd m\u1ed9t c\xe1ch an to\xe0n nh\u1ea5t."),Object(l.b)("p",null,"V\u1edbi v\xed d\u1ee5 \u1edf ",Object(l.b)("a",Object(c.a)({parentName:"p"},{href:"#nh%c6%b0ng-t%e1%ba%a1i-sao-c%c3%b3-l%e1%bb%97-h%e1%bb%95ng-n%c3%a0y"}),"ph\u1ea7n tr\xean"),", ch\xfang ta s\u1ebd th\u1eed \u0111\u01b0a n\xf3 v\u1ec1 d\u1ea1ng truy v\u1ea5n tham s\u1ed1:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-php"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// C\xe2u l\u1ec7nh SQL ch\u1edd tham s\u1ed1"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$sql = "SELECT * FROM USERS'),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  WHERE email = ?"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  AND password = ?"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'  LIMIT 1";'),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// Chu\u1ea9n b\u1ecb v\xe0 r\xe0ng bu\u1ed9c"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$stmt = $connection->prepare($sql);"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$stmt->bind_param("ss", $email, $password);'),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// Truy\u1ec1n tham s\u1ed1 v\xe0 th\u1ef1c thi"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$email = $_POST['email'];"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$password = $_POST['password'];"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$stmt->execute();"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// \u0110\u1eebng qu\xean close connection m\u1ed7i l\u1ea7n th\u1ef1c thi xong"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$stmt->close();"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$conn->close();"),"\n")),Object(l.b)("p",null,"D\u1ea1ng ",Object(l.b)("strong",{parentName:"p"},"bind")," param n\xe0y ch\u1eafc c\xf3 l\u1ebd s\u1ebd kh\xf3 \u0111\u1ec3 truy\u1ec1n tham s\u1ed1 khi s\u1ed1 l\u01b0\u1ee3ng column c\u1ea7n d\xf9ng trong query tr\u1edf n\xean nhi\u1ec1u h\u01a1n, v\u1eady n\xean c\xf2n c\xf3 c\xe1ch nh\u01b0 sau:"),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-php"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// C\xe2u l\u1ec7nh SQL ch\u1edd tham s\u1ed1"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$sql = "SELECT * FROM USERS'),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  WHERE email = :email"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  AND password = :password"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'  LIMIT 1";'),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// Chu\u1ea9n b\u1ecb v\xe0 r\xe0ng bu\u1ed9c"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$stmt = $connection->prepare($sql);"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$stmt->bindParam(":email", $email);'),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),'$stmt->bindParam(":password", $password);'),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"// Truy\u1ec1n tham s\u1ed1 v\xe0 th\u1ef1c thi"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$email = $_POST['email'];"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$password = $_POST['password'];"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"$stmt->execute();"),"\n")),Object(l.b)("p",null,"V\xed d\u1ee5 trong m\u1ed9t s\u1ed1 ng\xf4n ng\u1eef kh\xe1c:"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"C#")),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-csharp"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// Create the SQL command."),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SqlCommand"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," command "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"new"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SqlCommand"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),'"select * from users where email = @email"'),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),", conn);"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// Add the parameter values in separately."),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"command.Parameters."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"Add"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"new"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"SqlParameter"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),'"email"'),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),", email);"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"using"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," (SqlDataReader reader "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," command."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"ExecuteReader"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"())"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"{"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"while"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," (reader."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"Read"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"())"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  {"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"    "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// Do something with the retrieved data."),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  }"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"}"),"\n")),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Django")),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-python"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"# Good"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"Users.objects."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"filter(email"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"email)"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"# Good"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"Users.objects."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"raw("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),'"select * from users where email = %s"'),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),", [email])"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"# Liable to got hacked"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"Users.objects."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"raw("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"\"select * from users where email = '%s'\""),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"%"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}})," email)"),"\n")),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Node")),Object(l.b)("pre",null,Object(l.b)("code",Object(c.a)({parentName:"pre"},{className:"language-js"}),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// node-sql"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"var"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," sql "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"require"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'sql'"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),");"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"var"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," query "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," user."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"select"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"(user."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"star"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"()))"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"                ."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"from"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"(user)"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"                ."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"where"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"(user.email."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"equals"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"(email))."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"toQuery"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"();"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// mysql"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"var"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," mysql "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#005CC5"}}),"require"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'mysql'"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),");"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"var"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," connection "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"="),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," mysql."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"createConnection"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"({ host"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),":"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," HOST, user"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),":"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," USERNAME, password"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),":"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}})," PASSWORD });"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"connection."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"connect"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"();"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"connection."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"query"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"("),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#22863A"}}),"'select * from users where email = ?'"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),","),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  [email],"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#D73A49"}}),"function"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"(err, rows, fields) {"),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"    "),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6A737D"}}),"// Do something with the retrieved data."),"\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"  });"),"\n","\n",Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"connection."),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#6F42C1"}}),"end"),Object(l.b)("span",Object(c.a)({parentName:"code"},{style:{color:"#000000"}}),"();"),"\n")),Object(l.b)("h4",{id:"h\xe3y-validation-t\u1eeb-front-end-cho-t\u1edbi-back-end"},"H\xe3y validation t\u1eeb Front-end cho t\u1edbi Back-end"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Validation")," d\u1eef li\u1ec7u ch\u01b0a bao gi\u1edd l\xe0 c\xf4ng vi\u1ec7c th\xfa v\u1ecb :okay: tuy nhi\xean vi\u1ec7c validation 2 b\u01b0\u1edbc gi\xfap b\u1ea3o m\u1eadt t\u1ed1t h\u01a1n, v\xe0 \u0111\u1ed3ng th\u1eddi c\u0169ng tr\xe1nh \u0111\u01b0\u1ee3c c\xe1c l\u1ed7i l\u1eb7t v\u1eb7t kh\xf4ng c\u1ea7n thi\u1ebft."),Object(l.b)("p",null,"V\xed d\u1ee5 tr\xean front-end c\xe1c field nh\u1eadp v\xe0o d\u1eef li\u1ec7u s\u1ed1, n\xean d\xf9ng input ",Object(l.b)("inlineCode",{parentName:"p"},"number")," thay v\xec input ",Object(l.b)("inlineCode",{parentName:"p"},"text"),". C\xe1c field b\u1eaft bu\u1ed9c th\xec n\xean ",Object(l.b)("inlineCode",{parentName:"p"},"required"),". M\u1eb7c d\xf9 tr\xean front-end c\xf3 th\u1ec3 verify d\u1eef li\u1ec7u \u0111\u1ea7u v\xe0o, nh\u01b0ng attacker v\u1eabn c\xf3 th\u1ec3 ignore nh\u1eefng rule n\xe0y \u0111\u1ec3 tr\u1ef1c ti\u1ebfp g\u1eedi d\u1eef li\u1ec7u v\xe0o back-end, v\u1eady n\xean tr\xean back-end ch\xfang ta n\xean verify l\u1ea1i d\u1eef li\u1ec7u, nh\u01b0 ki\u1ec3u ",Object(l.b)("inlineCode",{parentName:"p"},"$age = (int)$_POST['age']"),". \u0110i\u1ec1u n\xe0y s\u1ebd tr\xe1nh \u0111\u01b0\u1ee3c c\xe1c y\u1ebfu t\u1ed1 g\xe2y ra l\u1ed7i kh\xf4ng \u0111\xe1ng c\xf3."),Object(l.b)("h4",{id:"ph\xe2n-quy\u1ec1n-qu\u1ea3n-tr\u1ecb"},"Ph\xe2n quy\u1ec1n qu\u1ea3n tr\u1ecb"),Object(l.b)("p",null,"M\xecnh th\u1ea5y r\u1ea5t nhi\u1ec1u b\u1ea1n khi x\xe2y d\u1ef1ng project, th\u01b0\u1eddng s\u1eed d\u1ee5ng t\xe0i kho\u1ea3n ",Object(l.b)("strong",{parentName:"p"},Object(l.b)("inlineCode",{parentName:"strong"},"root"))," c\u1ee7a DBMS \u0111\u1ec3 l\xe0m t\u1ea5t c\u1ea3 m\u1ecdi th\u1ee9... \u0110\xf3 l\xe0 m\u1ed9t sai l\u1ea7m c\u1ef1c k\u1ef3 l\u1edbn. Ph\u1ea7n l\u1edbn c\xe1c b\u1ea1n \u0111\u1ec1u ch\u01b0a hi\u1ec3u m\u1ee9c \u0111\u1ed9 nghi\xeam tr\u1ecdng c\u1ee7a v\u1ea5n \u0111\u1ec1 n\xe0y, v\u1ea5n \u0111\u1ec1 n\xe0y gi\u1ea3i th\xedch c\u0169ng kh\xf3 hi\u1ec3u, ph\u1ea3i trong tr\u01b0\u1eddng h\u1ee3p th\u1ef1c t\u1ebf c\xe1c b\u1ea1n h\u1ecdc \u0111\u01b0\u1ee3c th\xec d\u1ec5 nh\u1edb h\u01a1n."),Object(l.b)("p",null,"Tuy nhi\xean m\xecnh v\u1eabn s\u1ebd \u0111\u01b0a ra m\u1ed9t v\xed d\u1ee5 \u0111\u01a1n gi\u1ea3n nh\u01b0 sau:"),Object(l.b)("p",null,"Khi b\u1ea1n \u0111\u0103ng nh\u1eadp, vi\u1ec7c c\u1ea7n l\xe0m c\u1ee7a database ch\u1ec9 l\xe0 v\xe0o \u0111\u1ecdc d\u1eef li\u1ec7u (quy\u1ec1n ",Object(l.b)("strong",{parentName:"p"},"READ"),") \u0111\u1ec3 verify th\xf4ng tin. Trong khi c\xe1c b\u1ea1n l\u1ea1i c\u1ea5p full quy\u1ec1n cho ",Object(l.b)("strong",{parentName:"p"},"user")," c\u1ee7a DBMS ch\u1ec9 d\xf9ng \u0111\u1ec3 \u0111\u1ecdc... Gi\u1ea3 s\u1eed form \u0111\u0103ng nh\u1eadp tr\xean h\u1ec7 th\u1ed1ng c\xf3 l\u1ed7 h\u1ed5ng SQL Injection, th\xec vi\u1ec7c attack t\u1eeb c\xe1i form login xo\xe1 to\xe0n b\u1ed9 d\u1eef li\u1ec7u c\u1ee7a b\u1ea1n l\xe0 \u0111i\u1ec1u c\u1ef1c k\u1ef3 \u0111\u01a1n gi\u1ea3n, c\xf2n n\u1ebfu user t\u01b0\u01a1ng t\xe1c v\u1edbi database ch\u1ec9 c\xf3 quy\u1ec1n \u0111\u1ecdc, th\xec attacker c\u0169ng ch\u1ec9 c\xf3 th\u1ec3 truy c\u1eadp t\xe0i kho\u1ea3n \u0111\xf3 m\xe0 th\xf4i."),Object(l.b)("p",null,"Ngh\u0129a l\xe0 b\u1ea1n ch\u1ec9 g\u1eb7p m\u1ed9t nguy c\u01a1 nh\u1ecf h\u01a1n so v\u1edbi c\xe1i nguy c\u01a1 c\u1ef1c k\u1ef3 kh\u1ee7ng khi\u1ebfp kia."),Object(l.b)("p",null,"\u0110\xf3, kh\xf4ng ph\u1ea3i t\u1ef1 d\u01b0ng m\xe0 ",Object(l.b)("strong",{parentName:"p"},"Oracle")," \u0111\u01b0\u1ee3c cho l\xe0 h\u1ec7 qu\u1ea3n tr\u1ecb database SQL b\u1ea3o m\u1eadt nh\u1ea5t, l\xfd do l\xe0 v\xec ph\xe2n quy\u1ec1n c\u1ee7a ",Object(l.b)("strong",{parentName:"p"},"Oracle")," c\u1ef1c k\u1ef3 ch\u1eb7t ch\u1ebd. Do \u0111\xf3, t\u1ed1t nh\u1ea5t n\xean ph\xe2n quy\u1ec1n cho c\xe1c user trong DBMS m\u1ed9t c\xe1ch ch\u1eb7t ch\u1ebd v\xe0 h\u1ee3p l\xfd, \u0111\u1ec3 tr\xe1nh h\u1ed1i h\u1eadn v\u1ec1 l\xe2u v\u1ec1 d\xe0i."),Object(l.b)("p",null,"V\u1ea5n \u0111\u1ec1 ph\xe2n quy\u1ec1n kh\xf4ng ph\u1ea3i ch\u1ec9 \u1edf trong DBMS, m\xe0 c\xf2n \u1edf trong c\u1ea3 h\u1ec7 th\u1ed1ng, v\xe0 c\u1ea5u h\xecnh ",Object(l.b)("strong",{parentName:"p"},"server"),". Nh\u1eafc l\u1ea1i l\u1ea7n n\u1eefa: ",Object(l.b)("strong",{parentName:"p"},"Ph\xe2n quy\u1ec1n c\u1ef1c k\u1ef3 quan tr\u1ecdng")),Object(l.b)("img",{title:"chmod 777 and you will see",alt:"chmod 777 and you will see",src:"/blog/sql-database-hacking/06.jpg"}),Object(l.b)("h2",{id:"k\u1ebft-lu\u1eadn"},"K\u1ebft lu\u1eadn"),Object(l.b)("p",null,"SQL Injection kh\xf4ng ph\u1ea3i m\u1ed9t v\u1ea5n \u0111\u1ec1 m\u1edbi m\u1ebb, n\xf3 t\u1ed3n t\u1ea1i c\u1ea3 m\u1ed9t th\u1eadp k\u1ef7 r\u1ed3i nh\u01b0ng n\xf3 v\u1eabn \u0111\u1ee9ng \u0111\u1ea7u b\u1ea3ng x\u1ebfp h\u1ea1ng v\u1ec1 c\xe1c l\u1ed7 h\u1ed5ng nguy hi\u1ec3m nh\u1ea5t trong nhi\u1ec1u n\u0103m li\u1ec1n. Ch\u1ec9 v\u1edbi m\u1ed9t v\xe0i b\u01b0\u1edbc d\u1ec5 d\xe0ng, h\u1ec7 th\u1ed1ng c\u1ee7a b\u1ea1n c\xf3 th\u1ec3 b\u1ecb t\xea li\u1ec7t ho\xe0n to\xe0n... Ch\u1ed1ng th\xec kh\xf3, m\xe0 ph\xe1 th\xec d\u1ec5 l\u1eafm."),Object(l.b)("p",null,"N\xean nh\u1edb:"),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"\u0110\u1ea1o cao m\u1ed9t th\u01b0\u1edbc, ma cao m\u1ed9t tr\u01b0\u1ee3ng.")))}j.isMDXComponent=!0}}]);